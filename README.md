# 123云盘 下载工具

## 项目介绍

123Pan 下载工具是一个使用 Python 编写的脚本，通过模拟安卓客户端协议来绕过 123Pan 的下载流量限制。该工具可以帮助用户在 linux 系统上方便地下载 123Pan 上的文件，并提供了多种操作功能，如列出文件、下载文件、上传文件、分享文件等

## 功能特点

- **路径式操作**: 完全采用类似 `cd`, `ls`, `download` 的路径操作，支持绝对路径、相对路径 (`./`, `../`)，告别繁琐的数字编号。
- **自动登录与会话保持**: 首次运行输入用户名密码后，会自动保存会话信息到 `123pan.txt`。后续运行无需再次登录，Token失效后会自动尝试重新登录。
- **命令与路径补全**: 支持使用 `Tab` 键自动补全命令、远程文件和目录路径，极大提升操作效率。
- **强大的下载功能**:
    - 支持多文件同时下载 (`download file1 file2...`)。
    - 支持通配符 (`*`, `?`) 匹配下载 (例如 `download *.zip`)。
    - 支持目标下载路径，需要绝对路径。
    - 多线程并行下载，提升下载速度。
    - 清晰的下载进度条，并自动跳过已存在文件。
- **丰富的文件管理**:
    - 文件和目录列表 (`ls`)，彩色高亮显示。
    - 目录切换 (`cd`) 和当前路径显示 (`pwd`)。
    - 创建目录 (`mkdir`)，支持递归创建 (`mkdir a/b/c`)。
    - 删除文件/目录 (`delete`)。
    - 获取文件直链 (`link`)。

## 使用方法

### 环境准备

1.  确保已安装 Python 3.x。
2.  安装所需的 Python 库（如果出错，可以尝试忽略这一步安装）：
```bash
pip install requests
```

### 配置文件

首次运行脚本时，会自动生成 `123pan.txt` 保存登录信息（账号、密码、授权 token）。

### 运行脚本

将 `web.py` 和 `sign_py.py` 放置在同一目录下，然后运行：
```bash
python web.py
```
- **首次登录**: 首次运行会提示 `配置读取失败`。按照提示输入你的123网盘 **用户名 (手机号)** 和 **密码** 即可。
- **开始操作**: 登录成功后，你将看到一个命令提示符，如 `123pan:/$`，在此可以输入各种命令进行操作。

### 命令说明 (路径版)

| 命令 | 参数 | 功能说明 |
| :--- | :--- | :--- |
| `ls` | `[path]` | 列出指定路径或当前目录的内容。目录显示为紫色，文件为黄色。 |
| `cd` | `<path>` | 切换到指定目录。支持 `..` 返回上一级。 |
| `pwd` | | 显示当前所在的远程路径。 |
| `download` | `<path...>` | 下载一个或多个文件。支持使用通配符，例如 `download *.zip`。 |
| `link` | `<path>` | 获取指定文件的直接下载链接。 |
| `delete` | `<path>` | 删除指定的文件或目录。 |
| `mkdir` | `<path>` | 创建目录。支持递归创建，例如 `mkdir a/b/c`。 |
| `setdir` | `<local_path>` | 设置文件的本地下载目录。支持Tab补全本地路径。 |
| `re` | | 强制刷新当前目录的文件列表缓存。 |
| `log` | | 手动执行一次登录操作，以刷新会话Token。 |
| `reload` | | 从 `123pan.txt` 重新加载配置。 |
| `help` | | 显示此帮助信息。 |
| `exit` | | 退出程序。 |

### 功能示例

1.  **浏览和切换目录**:
    ```bash
    123pan:/$ ls
    d  我的资料                  -
    d  电影                      -

    123pan:/$ cd 我的资料/
    进入 /我的资料
    123pan:/我的资料$
    ```
2.  **通配符下载**:
    ```bash
    123pan:/我的资料$ download *.docx
    批量下载文件数: 3
    开始下载: report-v1.docx 大小 1.25M
    ...
    ```

## 注意事项

- `share` (分享) 和 `upload` (上传) 命令暂未完全适配新的路径模式，功能可能不稳定。
- 直接下载整个目录的功能暂不支持。
- 脚本通过模拟Web端API工作，如果123网盘官方API发生变动，脚本可能会失效。
- 并行下载默认线程数为 3，可按需在代码中调整 `self.max_workers`。

## 免责声明

本工具仅供学习与技术研究，严禁用于任何商业或非法用途，由使用者自行承担相关风险。
